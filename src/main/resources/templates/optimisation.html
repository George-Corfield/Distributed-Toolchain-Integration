<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">

<head>
    <link rel="stylesheet" th:href="@{/optimisationStyle.css}">
    <meta charset="UTF-8">
    <title th:text="${part.partName}"></title>
</head>

<body>
    <div class = "header-container">
        <h1 th:text="${part.partName}"></h1>
        <div class = "button-container">
            <button class="new-variable-button" onclick="addVarForm()">NEW VARIABLE</button>
        </div>
    </div>    

    <table class="variable-table">
        <thead>
            <tr>
                <th>Variable Name</th>
                <th>Initial Value</th>
                <th>Lower Bound</th>
                <th>Upper Bound</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="var : ${currentVariables}">
                <td th:text="${var.variableName}"></td>
                <td th:text="${var.initVal}"></td>
                <td th:text="${var.lowBound}"></td>
                <td th:text="${var.upBound}"></td>
            </tr>
        </tbody>
    </table>
   

    <div class="variable-form-popup" id="var-form" style="display:none;">
        <form class="form" action="#" th:action="@{'/projects/' + ${projectName} + '/' + ${part.partId}}" th:object="${variable}" method="post">
            <h1>Add Variable</h1>

            <label for="variableName"><b>Name</b></label>
            <input type="text" placeholder="Name" th:field="*{variableName}" required/>
            <br>
            <label for="initVal"><b>Initial Value</b></label>
            <input type="float" placeholder="Initial" th:field="*{initVal}" required/>
            <br>
            <label for="lowBound"><b>Lower Bound</b></label>
            <input type="float" placeholder="Lower" th:field="*{lowBound}" required/>
            <br>
            <label for="upBound"><b>Upper Bound</b></label>
            <input type="float" placeholder="Upper" th:field="*{upBound}" required/>

            <button type="submit">Submit</button>
        </form>
        <p class="message" onclick="cancelPart()">Cancel new variable</p>
    </div> 

    <div class="upload-form">
        <form method="POST" enctype="multipart/form-data" action="#" th:action="@{'/projects/varsfile/' + ${projectName} + '/' + ${part.partId}}">
            <div class="form-group">
                <label for="file">Upload File:</label>
                <input class="file-input" type="file" name="file" id="file" />
                <button class="upload-button" type="submit">Upload</button>
            </div>
        </form>
    </div>
    <div>
        <ul class="file-list">
            <li th:each="file : ${files}">
                <a th:href="${file}" th:text="${file}"></a>
            </li>
        </ul>
    </div>

    <div style="float: left;">
        <h2>Results</h2>
        <span th:if="${results.isEmpty()}">No Current Results</span>
        <span th:if="${not results.isEmpty()}">
            <table>
                <tr>
                    <th>Result Id</th>
                    <th>Variables Values</th>
                    <th>Output Value</th>
                    <th>Fitness</th>
                </tr>
                <tr th:each="r : ${results}">
                    <th th:text="${r.resultId}"></th>
                    <th>
                        <ul>
                            <li th:each="var : ${r.variables}" th:text="${var.variableName} + ' : ' + ${var.initVal}"></li>
                        </ul>
                    </th>
                    <th th:text="${r.outputValue}"></th>
                    <th th:text="${r.fitnessLevel}"></th>
                </tr>
            </table>
        </span>
    </div>
</body>

<script>
    function addVarForm() {
        document.getElementById("var-form").style.display = "block";
    }
    function cancelPart() {
        document.getElementById("var-form").style.display ="none";
    }
</script>
</html>